---
tags:
  - ComputerVision
  - Math/LinearAlgebra
  - Robotics/Slam
  - ROS
created: 2025-12-28
---


# 计算机视觉初步：相机原理与变换矩阵

> [!abstract] 核心摘要
> 本课件讲解了从三维世界到二维图像的成像过程（3D $\to$ 2D）。
> 核心在于建立 **四大坐标系** 模型，并通过 **齐次坐标** 与 **矩阵变换** 描述这一过程。

## 1. 四大坐标系构建

为了用数学语言描述针孔相机模型，我们需要理解以下四个核心坐标系：

| 坐标系名称 | 符号 | 描述 | 备注 |
| :--- | :--- | :--- | :--- |
| **世界坐标系** | $(X_w, Y_w, Z_w)$ | 绝对坐标系 | 描述物体在真实世界中的位置 (如 GPS 坐标) |
| **相机坐标系** | $(X_c, Y_c, Z_c)$ | 以相机光心为原点 | $Z_c$ 沿光轴指向前方，$Y_c$ 通常向下 |
| **图像坐标系** | $(x, y)$ | 物理成像平面 | 单位为物理长度 (mm)，原点在光轴与平面的交点 |
| **像素坐标系** | $(u, v)$ | 图像平面 | 单位为像素 (pixel)，原点 $O_0$ 位于图像左上角 |

> [!NOTE] 关于成像平面的处理
> * **物理成像平面**：位于 $Z_c = -f$ 处，成**倒立像**。
> * **虚拟成像平面**：为简化计算，数学上假设位于相机前方 $Z_c = f$ 处，成**正立像**（计算机视觉中通常使用此模型）。

---

## 2. 变换矩阵的基础数学

为了统一处理旋转、缩放和平移，引入了 **齐次坐标 (Homogeneous Coordinates)**。

* **线性变换的局限**：$2\times2$ 矩阵只能描述旋转和缩放，无法描述平移（平移是非线性的）。
* **齐次坐标的威力**：
    * 将 $n$ 维向量提升到 $n+1$ 维（例如 $(x, y) \to (x, y, 1)$）。
    * **效果**：平移、旋转、缩放都可以通过一个矩阵乘法来表示，实现了变换的统一构造。

---

## 3. 相机内参矩阵 (Intrinsics)



内参矩阵 $K$ 描述了 **相机坐标系 $\to$ 像素坐标系** 的映射关系。

### 3.1 推导逻辑

```mermaid
graph LR
    A["相机坐标系 3D"] -->|透视除法 / Z| B["归一化平面 2D"]
    B -->|"乘以焦距 f"| C["虚拟成像平面 (物理单位)"]
    C -->|"离散化 dx, dy <br> 平移 u0, v0"| D["像素坐标系 (u, v)"]
````

### 3.2 变换公式

从物理平面 $(x,y)$ 到像素平面 $(u,v)$ 的变换：

$$\begin{cases} u = \frac{x}{dx} + u_0 \\ v = \frac{y}{dy} + v_0 \end{cases}$$

### 3.3 最终形式 (重要)

> [!thm] 内参矩阵 $K$
> 
> $$Z\_c \begin{bmatrix} u \\ v \\ 1 \end{bmatrix} = \underbrace{\begin{bmatrix} f\_x & 0 & c\_x \\ 0 & f\_y & c\_y \\ 0 & 0 & 1 \end{bmatrix}}\_{K} \begin{bmatrix} X\_c \\ Y\_c \\ Z\_c \end{bmatrix}$$
> 
> **参数含义：**
> 
> - $f_x = f / dx, \ f_y = f / dy$：以像素为单位的焦距（缩放因子）。
>     
> - $c_x, c_y$ (即 $u_0, v_0$)：主点（光心在图像上的投影）的像素坐标。
>     

---

## 4. 坐标系间的多重变换 (Extrinsics)

这部分描述如何将点从 **世界坐标系** 变换到 **像素坐标系**。这对无人机/机器人开发尤为重要。

### 变换链条

$$\text{像素} \xleftarrow{K} \text{相机} \xleftarrow{T_b^c} \text{机体} \xleftarrow{T_w^b} \text{世界}$$

### 关键步骤分解

1. **世界系 $\to$ 机体系 ($T_w^b$)**：
    
    - 描述无人机在世界中的位姿（位置 + 姿态/欧拉角）。
        
2. **机体系 $\to$ 相机系 ($T_b^c$)**：
    
    - **外参标定核心**：相机安装在无人机上的位置偏移和旋转。
        
    - **注意坐标轴定义**：机体坐标系通常是 **前-左-上 (FLU)** 或 **北-东-地 (NED)**，而相机坐标系通常是 **Z轴向前**。这里必须进行旋转变换以对齐轴向。
        

### 完整公式

$$Z_c \begin{bmatrix} u \\ v \\ 1 \end{bmatrix} = K \cdot \underbrace{\begin{bmatrix} R & t \end{bmatrix}}_{Extrinsics} \cdot \begin{bmatrix} X_w \\ Y_w \\ Z_w \\ 1 \end{bmatrix}$$

或者写成级联形式：

$$T_{final} = K \cdot T_b^c \cdot T_w^b$$

---

## 5. 重点思考与工程问题

> [!question] 思考题
> 
> 1. 标定 (Calibration)：
>     
>     如何通过张正友标定法（棋盘格）反求出矩阵 $K$ 和畸变系数？
>     
> 2. 逆变换 (Back-projection)：
>     
>     已知像素坐标 $(u,v)$，能否求出世界坐标 $(X_w, Y_w, Z_w)$？
>     
>     - **答案**：不能直接求出唯一解。
>         
>     - **原因**：缺乏深度信息 $Z_c$（丢失了一个维度）。$(u,v)$ 对应的是空间中的一条射线。
>         
>     - **解法**：必须补充深度信息（如使用 RGB-D 相机、激光雷达或假设地面平面）。
>         

