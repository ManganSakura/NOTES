## 1. 正交性 (Orthogonality)

### 1.1 向量正交

- **定义**：两个向量 $\mathbf{x}$ 和 $\mathbf{y}$ 是正交的，如果它们的点积为零：
    
    $$ \mathbf{x}^T \mathbf{y} = 0$$
    
- **勾股定理**：若 $\mathbf{x} \perp \mathbf{y}$，则 $||\mathbf{x} + \mathbf{y}||^2 = ||\mathbf{x}||^2 + ||\mathbf{y}||^2$。
    

### 1.2 子空间正交

- **定义**：如果空间 $S$ 中的**每一个**向量都与空间 $T$ 中的**每一个**向量正交，则称子空间 $S$ 与 $T$ 正交。
    
- **基本子空间的正交关系**：
    
    - **行空间 $\perp$ 零空间** ($C(A^T) \perp N(A)$)
        
    - **列空间 $\perp$ 左零空间** ($C(A) \perp N(A^T)$)
        

---

## 2. 投影 (Projections)

### 2.1 投影到直线 (1D)

我们要把向量 $\mathbf{b}$ 投影到向量 $\mathbf{a}$ 所在的直线上，得到投影向量 $\mathbf{p} = \hat{x}\mathbf{a}$。

- **误差向量**：$\mathbf{e} = \mathbf{b} - \mathbf{p}$。
    
- **正交条件**：误差 $\mathbf{e}$ 必须垂直于直线 $\mathbf{a}$，即 $\mathbf{a}^T(\mathbf{b} - \hat{x}\mathbf{a}) = 0$。
    
- **公式**：
    
    $$ \hat{x} = \frac{\mathbf{a}^T \mathbf{b}}{\mathbf{a}^T \mathbf{a}} \quad \implies \quad \mathbf{p} = \mathbf{a} \frac{\mathbf{a}^T \mathbf{b}}{\mathbf{a}^T \mathbf{a}}$$
    

### 2.2 投影到子空间 (High Dimensions)

我们要把向量 $\mathbf{b}$ 投影到矩阵 $A$ 的**列空间** $C(A)$ 上，得到投影向量 $\mathbf{p} = A\hat{\mathbf{x}}$。

- **正交条件**：误差 $\mathbf{e} = \mathbf{b} - A\hat{\mathbf{x}}$ 必须垂直于整个列空间（即垂直于 $A$ 的每一列）。
    
    $$ A^T (\mathbf{b} - A\hat{\mathbf{x}}) = \mathbf{0}$$
    
- **正规方程 (Normal Equation)** —— **极重要**：
    
    $$ A^T A \hat{\mathbf{x}} = A^T \mathbf{b}$$
    
- **投影矩阵 $P$ (Projection Matrix)**：
    
    $$ \mathbf{p} = A(A^T A)^{-1} A^T \mathbf{b} \quad \implies \quad P = A(A^T A)^{-1} A^T$$
    
    - 性质 1：$P^2 = P$（投影两次等于投影一次）。
        
    - 性质 2：$P^T = P$（对称矩阵）。
        

---

## 3. 最小二乘法 (Least Squares)

### 3.1 问题背景

当方程组 $A\mathbf{x} = \mathbf{b}$ **无解**时（通常因为方程太多 $m > n$，且有噪音），我们需要找一个最优解 $\hat{\mathbf{x}}$，使得误差平方和 $E = ||A\mathbf{x} - \mathbf{b}||^2$ 最小。

### 3.2 几何解释

- $A\mathbf{x}$ 永远在列空间 $C(A)$ 里。
    
- $\mathbf{b}$ 不在列空间里（所以无解）。
    
- **最近的点**：列空间里距离 $\mathbf{b}$ 最近的点，就是 $\mathbf{b}$ 在 $C(A)$ 上的**投影** $\mathbf{p}$。
    
- **解法**：我们实际上是在解 $A\hat{\mathbf{x}} = \mathbf{p}$。
    

### 3.3 计算步骤 (Standard Algorithm)

1. 列出方程 $A\mathbf{x} = \mathbf{b}$（发现无解）。
    
2. 左右两边同时乘以 $A^T$，得到**正规方程**：
    
    $$(A^T A) \hat{\mathbf{x}} = A^T \mathbf{b}$$
    
3. 解这个方程组求出 $\hat{\mathbf{x}}$。这就是最小二乘解。
    

### 3.4 示例：拟合直线

有三个点 $(1, 1), (2, 2), (3, 2)$，想拟合直线 $y = C + Dt$。

- 矩阵形式 $A\mathbf{x}=\mathbf{b}$：
    
    $$ \begin{bmatrix} 1 & 1 \\ 1 & 2 \\ 1 & 3 \end{bmatrix} \begin{bmatrix} C \\ D \end{bmatrix} = \begin{bmatrix} 1 \\ 2 \\ 2 \end{bmatrix}$$
    
- 计算 $A^T A = \begin{bmatrix} 3 & 6 \\ 6 & 14 \end{bmatrix}$。
    
- 计算 $A^T \mathbf{b} = \begin{bmatrix} 5 \\ 11 \end{bmatrix}$。
    
- 解 $\begin{bmatrix} 3 & 6 \\ 6 & 14 \end{bmatrix} \begin{bmatrix} \hat{C} \\ \hat{D} \end{bmatrix} = \begin{bmatrix} 5 \\ 11 \end{bmatrix}$，得到最优直线。
    

![Image of least squares line fitting graph](https://encrypted-tbn3.gstatic.com/licensed-image?q=tbn:ANd9GcQfjQ0Ul7WEhQztZQtZuYJysQJk3hzQW6Zfs_YCIqx2I27dhryd18bXphVyNoqwVu7v2yogaQU3-wKfRmC_PXVjcz4I2NrLScrNKhE9Sq0MdQwd6Ro)

Shutterstock

---

## 4. 正交基与 Gram-Schmidt

### 4.1 标准正交基 (Orthonormal Basis)

如果基向量 $\mathbf{q}_1, \dots, \mathbf{q}_n$ 满足：

1. 单位长度 ($||\mathbf{q}_i|| = 1$)
    
2. 两两正交 ($\mathbf{q}_i^T \mathbf{q}_j = 0$)
    
    则称其为标准正交基。
    

- **矩阵性质**：如果 $Q$ 的列是标准正交的，则 $Q^T Q = I$。
    
- **优势**：在正交基下计算投影极其简单，不需要求逆矩阵，$\hat{x}_i = \mathbf{q}_i^T \mathbf{b}$。
    

### 4.2 Gram-Schmidt 正交化

如何把一组普通的基 $\mathbf{a}, \mathbf{b}$ 变成标准正交基 $\mathbf{q}_1, \mathbf{q}_2$？

1. **第一步**：$\mathbf{A} = \mathbf{a}$。
    
2. **第二步**：从 $\mathbf{b}$ 中减去它在 $\mathbf{A}$ 上的投影（去掉相关部分，只留垂直部分）。
    
    $$\mathbf{B} = \mathbf{b} - \frac{\mathbf{A}^T \mathbf{b}}{\mathbf{A}^T \mathbf{A}}\mathbf{A}$$
    
3. **第三步**：归一化。$\mathbf{q}_1 = \mathbf{A}/||\mathbf{A}||, \mathbf{q}_2 = \mathbf{B}/||\mathbf{B}||$。
    

### 4.3 QR 分解

任何长方形矩阵 $A$（列线性无关）都可以分解为：

$$A = Q R$$

- **Q**：正交矩阵（列是标准正交基）。
    
- **R**：上三角矩阵（包含了 Gram-Schmidt 过程中的系数）。
    
- **意义**：这使得数值计算极其稳定，是现代算法求解最小二乘法的首选方式。
    

---
