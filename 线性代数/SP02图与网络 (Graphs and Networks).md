这一章的核心思想是：矩阵是图的描述，图是矩阵的直观。

我们将利用关联矩阵 (Incidence Matrix) 这一工具，推导出欧拉公式、基尔霍夫定律 (KVL/KCL) 以及核心平衡方程 $A^T C A$。

## 1. 基础模型：图 (Graph)

一个图由两个基本元素组成：

- **节点 (Nodes)**：数量为 $n$。
    
- **边 (Edges)**：数量为 $m$。
    

### 关联矩阵 $A$ (Incidence Matrix)

这是一个 $m \times n$ 的矩阵，用来数字化地描述“谁连着谁”。

- **每一行**代表一条边。
    
- **每一列**代表一个节点。
    
- **规则**（Strang 惯例）：
    
    - 边 $i$ 从节点 $j$ **流出** $\rightarrow$ $A_{ij} = -1$。
        
    - 边 $i$ **进入**节点 $k$ $\rightarrow$ $A_{ik} = +1$。
        
    - 其他位置为 0。
        

### 示例：三角形图

假设有 3 个节点，3 条边构成一个回路。

- 边 1: Node 1 $\to$ Node 2
    
- 边 2: Node 2 $\to$ Node 3
    
- 边 3: Node 3 $\to$ Node 1 (形成闭环)
    

$$A = \begin{bmatrix} -1 & 1 & 0 \\ 0 & -1 & 1 \\ 1 & 0 & -1 \end{bmatrix}$$

> **注意**：每一行的和必然为 0（一进一出）。

---

## 2. 矩阵运算的物理意义

### 2.1 $Ax$：电势差 (Potential Differences)

设 $\mathbf{x} = [x_1, x_2, x_3]^T$ 为各节点上的电势 (Potentials)。

计算 $Ax$：

$$A\mathbf{x} = \begin{bmatrix} -1 & 1 & 0 \\ 0 & -1 & 1 \\ 1 & 0 & -1 \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \\ x_3 \end{bmatrix} = \begin{bmatrix} x_2 - x_1 \\ x_3 - x_2 \\ x_1 - x_3 \end{bmatrix}$$

- **结论**：$A\mathbf{x}$ 向量代表了**边上的电势差（电压降）**。
    

### 2.2 $A^T \mathbf{y}$：电流平衡 (Current Balance)

设 $\mathbf{y} = [y_1, y_2, y_3]^T$ 为各边上的电流 (Currents)。

计算 $A^T \mathbf{y}$（注意是对列求和）：

$$A^T \mathbf{y} = \begin{bmatrix} -1 & 0 & 1 \\ 1 & -1 & 0 \\ 0 & 1 & -1 \end{bmatrix} \begin{bmatrix} y_1 \\ y_2 \\ y_3 \end{bmatrix} = \begin{bmatrix} -y_1 + y_3 \\ y_1 - y_2 \\ y_2 - y_3 \end{bmatrix}$$

- **含义**：结果向量的第 $k$ 个分量表示节点 $k$ 的 **(流入电流 - 流出电流)**。
    
- **KCL 定律**：$A^T \mathbf{y} = \mathbf{0}$ 正是**基尔霍夫电流定律**（节点处净电流为0）。
    

---

## 3. 四个子空间对应的物理定律

这是将线性代数与电路理论完美结合的部分：

|**子空间**|**符号**|**维数**|**物理意义**|
|---|---|---|---|
|**零空间**|$N(A)$|$1$|**等电势**。$A\mathbf{x}=\mathbf{0}$ 意味着无电压降，即 $x_1=x_2=x_3$。所有节点电势相等（常数向量）。|
|**列空间**|$C(A)$|$n-1$|**满足 KVL 的电压**。方程 $A\mathbf{x}=\mathbf{b}$ 有解 $\iff$ 沿回路的电压降之和为0。|
|**左零空间**|$N(A^T)$|$m-(n-1)$|**回路电流**。$A^T\mathbf{y}=\mathbf{0}$ 的解即为在该图中流动的“环流”。|
|**行空间**|$C(A^T)$|$n-1$|相对复杂的概念，通常指满足电流守恒的节点电流分布。|

### 维数公式与欧拉公式

- 图是连通的，秩 $r = n-1$（因为列之间有个全 1 向量的相关性）。
    
- 左零空间的维数 = $m - r = m - (n - 1)$。
    
- **欧拉公式**：
    
    $$ \text{Loops} = \text{Edges} - (\text{Nodes} - 1)$$
    
    即：$\text{Nodes} - \text{Edges} + \text{Loops} = 1$。
    

---

## 4. 核心方程：$A^T C A$ (平衡方程)

如果我们把物理学的三个定律连起来：

1. **物理定律 1（定义）**：$e = A\mathbf{x}$
    
    - 电势 $\mathbf{x} \to$ 电势差 $e$。
        
2. **物理定律 2（属性）**：$\mathbf{y} = C e$
    
    - **欧姆定律**：电流 = 电导 $\times$ 电压。
        
    - $C$ 是对角矩阵，对角元 $c_i = 1/R_i$ 是第 $i$ 条边的**电导**。
        
3. **物理定律 3（平衡）**：$A^T \mathbf{y} = \mathbf{f}$
    
    - KCL：流出节点的净电流 = 外部注入的电流源 $\mathbf{f}$。
        

三合一：

将 1 和 2 代入 3，得到图论与网络中最著名的方程：

$$\underbrace{A^T C A}_{\text{刚度矩阵 } K} \mathbf{x} = \mathbf{f}$$

### 关于 $A^T C A$ 的性质

1. **对称性**：显然是对称的。
    
2. **半正定**：它是半正定的，因为 $N(A)$ 中包含非零向量（常数向量）。
    
3. **如何求解**：
    
    - 直接解是无解的（因为矩阵奇异，电势是相对的）。
        
    - **接地 (Grounding)**：将某个节点（如 $x_n$）设为 0。这就相当于去掉了矩阵的最后一行和最后一列，剩下的矩阵是**对称正定**的，可逆，有唯一解。
        

---

总结：

这一章告诉我们，无论是在电路、水管网络还是桁架结构中，自然界的平衡总是遵循 $A^T C A \mathbf{x} = \mathbf{f}$ 这种形式。

- $A$ 描述结构（几何）。
    
- $C$ 描述材料（物理）。
    
- $\mathbf{x}$ 和 $\mathbf{f}$ 是输入和响应。